type essential_sidecar_app, domain;

app_domain(essential_sidecar_app)
net_domain(essential_sidecar_app)

# essential_sidecar app's data type is system_app_data_file.
allow essential_sidecar_app system_app_data_file:dir create_dir_perms;
allow essential_sidecar_app system_app_data_file:{ file lnk_file } create_file_perms;

allow essential_sidecar_app hal_sidecar_essential_default:binder call;
allow essential_sidecar_app hal_sidecar_essential_hwservice:hwservice_manager find;

allow essential_sidecar_app self:netlink_kobject_uevent_socket { bind create read setopt };

allow essential_sidecar_app usb_device:dir r_dir_perms;
allow essential_sidecar_app vendor_file:file rx_file_perms;

allow essential_sidecar_app activity_service:service_manager find;
allow essential_sidecar_app connectivity_service:service_manager find;
allow essential_sidecar_app display_service:service_manager find;
allow essential_sidecar_app network_management_service:service_manager find;
allow essential_sidecar_app notification_service:service_manager find;
allow essential_sidecar_app power_service:service_manager find;
allow essential_sidecar_app usb_service:service_manager find;

allow essential_sidecar_app ota_package_file:dir create_dir_perms;
allow essential_sidecar_app ota_package_file:file create_file_perms;
allow essential_sidecar_app sidecar_file:{ chr_file file } rw_file_perms;

r_dir_file(essential_sidecar_app, proc_net)
