type hal_sidecar_essential_default, domain;
hal_server_domain(hal_sidecar_essential_default, hal_sidecar_essential)

type hal_sidecar_essential_default_exec, exec_type, vendor_file_type, file_type;
init_daemon_domain(hal_sidecar_essential_default)

add_hwservice(hal_sidecar_essential_server, hal_sidecar_essential_hwservice)
allow hal_sidecar_essential_client hal_sidecar_essential_hwservice:hwservice_manager find;

allow hal_sidecar_essential_default sysfs_sidecar_file:dir search;
allow hal_sidecar_essential_default sysfs_sidecar_file:file rw_file_perms;
allow hal_sidecar_essential_default usb_serial_device:chr_file rw_file_perms;

dontaudit hal_sidecar_essential_default dumpstate_prop:file r_file_perms;
set_prop(hal_sidecar_essential_default, sidecar_prop)
